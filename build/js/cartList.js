var o=(m,e,t)=>new Promise((r,a)=>{var l=s=>{try{i(t.next(s))}catch(c){a(c)}},n=s=>{try{i(t.throw(s))}catch(c){a(c)}},i=s=>s.done?r(s.value):Promise.resolve(s.value).then(l,n);i((t=t.apply(m,e)).next())});import{renderListWithTemplate as h,getLocalStorage as y}from"./utils.js";export default class g{constructor(e,t){this.key=e,this.listElement=t,this.total=0,this.totalItems=0,this.newlistElements=[]}init(){return o(this,null,function*(){const e=y(this.key);this.newlistElements=this.newListOfProduct(e),this.calculateListTotal(this.newlistElements),this.renderList(this.newlistElements)})}newListOfProduct(e){let t=e,r=[];for(;t.length>0;){let a=[],l=t[0];a=t.filter(i=>i.Id==l.Id);let n={qty:a.length};Object.assign(l,n),r.push(l),t=t.filter(i=>i.Id!==l.Id)}return r}calculateListTotal(e){const t=e.map(r=>r.FinalPrice*r.qty);this.total=t.reduce((r,a)=>r+a),this.totalItems=e.length}calculateTotalItems(){return this.init(),this.totalItems}renderList(e){this.listElement.innerHTML="";const t=document.getElementById("cart-card-template");h(t,this.listElement,e,this.prepareTemplate),document.querySelector(".list-total").innerText+=` $${this.total}`}prepareTemplate(e,t){return e.querySelector(".cart-card__image img").src=t.Images.PrimarySmall,e.querySelector(".cart-card__image img").srcset+=t.Images.PrimaryMedium+" 1x, "+t.Images.PrimaryLarge+" 2x, "+t.Images.PrimaryExtraLarge+" 3x",e.querySelector(".cart-card__image img").alt+=t.Name,e.querySelector(".card__name").textContent=t.Name,e.querySelector(".cart-card__color").textContent=t.Colors[0].ColorName,e.querySelector(".cart-card__price").textContent+=t.FinalPrice,e.querySelector(".cart-card__quantity").textContent="qty: "+t.qty,e}}
